<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Novo Ponto de Coleta - EcoPronto</title>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>


<body>
    <header>
        
        <h2>EcoPronto</h2>
        <nav>
            <a href="index.html">Página Inicial</a>
            <a href="pontos.html">Pontos</a>
            <a href="login.html" class="btn btn-primary">Entrar</a>
            
        </nav>
    </header>

    <main class="section" style="max-width: 900px; margin: 0 auto;">
        <h1 style="font-size: 2rem; font-weight: 900; margin-bottom: 2rem;">Adicionar Novo Ponto de Coleta</h1>

        <form id="formAdicionarPonto"> 
            <section class="card" style="margin-bottom: 2rem;">
                <h3>Informações do Ponto</h3>
                <label>
                    <p>Nome do Ponto</p>
                    <input type="text" name="nome_ponto" placeholder="Digite o nome do ponto de coleta"
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; margin-bottom:1rem;">
                </label>
                <label>
                    <p>Descrição / Observações</p>
                    <textarea name="descricao" placeholder="Adicione uma descrição ou observações relevantes"
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; min-height:120px; resize:vertical; margin-bottom:1rem;"></textarea>
                </label>
                <label>
                    <p>Telefone (Opcional)</p>
                    <input type="tel" name="telefone" placeholder="(XX) XXXXX-XXXX"
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; margin-bottom:1rem;">
                </label>
                <label>
                    <p>Foto do Local</p>
                    <div
                        style="border:2px dashed var(--border-light); border-radius:12px; padding:2rem; text-align:center; background-color:var(--background-light); color:var(--text-light-secondary);">
                        <p style="margin:0;">Arraste e solte ou <strong style="color:var(--primary)">clique para
                                enviar</strong></p>
                        <p style="font-size:0.9rem; opacity:0.8;">PNG, JPG ou GIF (máx. 800x400px)</p>
                    </div>
                    <input type="file" name="foto_local" style="display:none;">
                </label>
            </section>

            <section class="card" style="margin-bottom: 2rem;">
                <h3>Endereço</h3>
                <label>
                    <p>Endereço</p>
                    <input type="text" name="logradouro" placeholder="Rua, Avenida, etc."
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; margin-bottom:1rem;">
                </label>
                <label>
                    <p>Número</p>
                    <input type="text" name="numero" placeholder="Ex: 123"
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; margin-bottom:1rem;">
                </label>
                <label>
                    <p>Cidade</p>
                    <input type="text" name="cidade" placeholder="Ex: São Paulo"
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; margin-bottom:1rem;">
                </label>
                <label>
                    <p>CEP</p>
                    <input type="text" name="cep" placeholder="00000-000"
                        style="width:100%; padding:0.75rem; border:1px solid var(--border-light); border-radius:8px; margin-bottom:1rem;">
                </label>

                <p>Localização no Mapa</p>
                <div style="border-radius:12px; overflow:hidden; margin-top:0.5rem;">
                    <img src="https://lh3.googleusercontent.com/aida-public/AB6AXuC728kWEEGW9ubiUkf3H1SZoIHu2Xhkvi3M7QHVGn5LIf9L1ReQnzkPYhEO8NiI5sm5o8XCQN0QTRNRACWqzqW3sTsmeJ3tIPcHb0q0Hu5jz3Z6htQ9KfKwPXcKgAw6AMp6draGkGj3uwSM1QYPA2xRr8b_6fkhrKBcPPsvlw72VYxzaFaI0hkV4yPSJxtkX_AJkltUwgccM3ZuYjpnN6SSra1gDjqssqYc5050rXP44isAktRYmGS0t9rLE9NXoDRGWSK4FuazX1I5"
                        alt="Mapa do local" style="width:100%; height:auto; display:block;">
                </div>
            </section>

            <section class="card" style="margin-bottom: 2rem;">
                <h3>Tipos de Resíduos Aceitos</h3>
                <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(160px, 1fr)); gap:1rem;">
                    <label><input type="checkbox" name="residuos" value="Plástico"> Plástico</label>
                    <label><input type="checkbox" name="residuos" value="Vidro"> Vidro</label>
                    <label><input type="checkbox" name="residuos" value="Metal"> Metal</label>
                    <label><input type="checkbox" name="residuos" value="Papel"> Papel</label>
                    <label><input type="checkbox" name="residuos" value="Eletrônicos"> Eletrônicos</label>
                    <label><input type="checkbox" name="residuos" value="Baterias"> Baterias</label>
                    <label><input type="checkbox" name="residuos" value="Orgânico"> Orgânico</label>
                    <label><input type="checkbox" name="residuos" value="Óleo de Cozinha"> Óleo de Cozinha</label>
                </div>
            </section>

            <div style="display:flex; justify-content:flex-end; gap:1rem;">
                <a href="pontos.html" class="btn btn-outline">Cancelar</a>
                <button type="submit" class="btn btn-primary">Salvar</button>
            </div>
        </form>
    </main>

    <footer>
        <p>© 2025 EcoPronto — Todos os direitos reservados.</p>
    </footer>
    <script>
    document.getElementById('formAdicionarPonto').addEventListener('submit', function(event) {
        event.preventDefault(); // Impede o envio padrão do formulário

        const form = event.target;
        const formData = new FormData(form);
        const dados = {};
        
        // Coleta dados de texto
        for (const [key, value] of formData.entries()) {
            if (key !== 'residuos') {
                dados[key] = value;
            }
        }

        // Coleta os resíduos marcados
        dados.residuos = [];
        form.querySelectorAll('input[name="residuos"]:checked').forEach(checkbox => {
            dados.residuos.push(checkbox.value);
        });

        // Envia os dados para o backend (supondo que esteja rodando em http://localhost:3000/pontos)
        fetch('/api/pontos', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dados)
        })
        .then(response => {
            if (!response.ok) {
                // Lidar com erros de status HTTP (4xx, 5xx)
                return response.json().then(err => { throw new Error(err.message || 'Erro ao salvar ponto.') });
            }
            return response.json();
        })
        .then(data => {
            alert('Ponto de coleta adicionado com sucesso!');
            // Redireciona para a lista de pontos
            window.location.href = 'pontos.html'; 
        })
        .catch(error => {
            console.error('Erro:', error);
            alert('Falha ao adicionar ponto: ' + error.message);
        });
    });
</script>
</body>

</html>